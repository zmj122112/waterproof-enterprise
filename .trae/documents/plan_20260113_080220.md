# 小程序框架重构计划

## 一、框架选择

**选择理由**：当前项目是Vue 3 + Vite项目，需要选择对Vue 3支持良好的小程序框架，降低学习和迁移成本。

**推荐框架**：uni-app

**优势**：
- 基于Vue 3，与现有项目技术栈一致
- 支持多端开发（微信小程序、支付宝小程序、H5等）
- 完善的生态系统和社区支持
- 丰富的组件库和插件市场
- 良好的性能表现

## 二、重构步骤

### 1. 环境准备
- 安装Node.js（版本≥14.18.0）
- 安装HBuilderX（uni-app官方推荐IDE）
- 安装微信开发者工具
- 安装uni-app CLI：`npm install -g @dcloudio/uvm`

### 2. 项目初始化
- 使用HBuilderX创建uni-app项目
- 选择Vue 3 + Vite模板
- 配置项目基本信息（名称、AppID等）

### 3. 目录结构调整
将现有Vue项目目录结构转换为uni-app目录结构：
```
# 现有结构
frontend-prototypes/
├── src/
│   ├── views/
│   │   └── c-mini/
│   ├── router/
│   ├── components/
│   └── App.vue

# uni-app结构
uni-app-wx/
├── pages/
│   ├── home/
│   ├── repair-estimate/
│   └── ...
├── components/
├── static/
├── App.vue
├── main.js
└── pages.json
```

### 4. 组件迁移
- 将现有Vue组件转换为uni-app组件
- 调整组件语法，适配uni-app规范
- 替换浏览器特有的API为小程序API
- 调整样式，适配小程序的rpx单位

### 5. 核心功能迁移

#### 5.1 首页模块
- 轮播图：使用uni-app的`swiper`组件
- 服务入口：使用`view`和`image`组件重构
- 找师傅/产品入口：适配小程序路由跳转

#### 5.2 报修/预约模块
- 表单组件：使用uni-app的`form`、`input`、`picker`等组件
- 表单验证：实现客户端验证
- 提交逻辑：适配小程序的网络请求API

#### 5.3 订单管理模块
- 订单列表：使用`uni-list`组件或自定义列表
- 订单详情：适配小程序的页面跳转
- 订单状态管理：统一状态分类

#### 5.4 个人中心模块
- 用户信息展示：适配微信登录
- 功能菜单：重构为小程序的列表样式
- 地址管理：使用微信地址选择API

### 6. 路由配置
- 将Vue Router配置转换为`pages.json`
- 配置底部导航栏
- 配置页面样式和导航栏

### 7. API适配

| 现有API | uni-app替代方案 |
|---------|----------------|
| `window`/`document` | 小程序全局对象 |
| `axios`/`fetch` | `uni.request()` |
| `localStorage` | `uni.setStorageSync()`/`uni.getStorageSync()` |
| `router.push()` | `uni.navigateTo()` |
| `window.location.href` | `uni.navigateTo()` |

### 8. 样式调整
- 将px单位转换为rpx（响应式像素）
- 调整CSS选择器，适配小程序规范
- 移除浏览器特有的CSS属性
- 优化样式性能，减少重排重绘

### 9. 测试与调试
- 在HBuilderX中编译项目
- 在微信开发者工具中调试
- 真机测试，适配不同设备
- 性能测试和优化

### 10. 性能优化
- 图片懒加载：使用`lazy-load`属性
- 分包加载：配置`pages.json`的分包规则
- 组件按需加载：使用`import()`动态导入
- 减少网络请求：合理使用缓存
- 优化渲染性能：减少不必要的渲染

### 11. 发布准备
- 配置小程序AppID
- 上传代码到微信开发者工具
- 填写版本信息和更新日志
- 提交审核

## 三、注意事项

### 1. 组件兼容性
- 避免使用浏览器特有的DOM操作
- 注意小程序组件的生命周期与Vue组件的差异
- 适配小程序的事件系统

### 2. API限制
- 小程序有严格的API调用限制
- 注意异步API的使用方式
- 适配小程序的登录授权流程

### 3. 性能优化
- 小程序对包大小有严格限制（主包≤2MB）
- 注意图片资源的大小和格式
- 优化页面加载速度

### 4. 开发工具
- 推荐使用HBuilderX进行开发
- 配合微信开发者工具进行调试
- 使用uni-app的调试工具进行性能分析

## 四、预期成果

- 完整的微信小程序代码
- 适配小程序的UI/UX设计
- 良好的性能表现
- 支持后续功能扩展
- 多端发布能力（可选）

## 五、资源准备

1. **小程序账号**：微信公众平台账号（已认证企业账号）
2. **开发工具**：HBuilderX、微信开发者工具
3. **设计资源**：小程序Logo、启动图、图标等
4. **API文档**：微信小程序开发文档、uni-app文档
5. **测试设备**：不同型号的手机，用于真机测试

## 六、时间规划

1. **环境准备**：1天
2. **项目初始化**：1天
3. **目录结构调整**：1天
4. **核心功能迁移**：5-7天
5. **样式调整和优化**：2-3天
6. **测试与调试**：3-5天
7. **发布准备**：1天

总计：14-19天

## 七、后续维护

- 定期更新框架版本
- 优化小程序性能
- 适配微信小程序的新功能
- 修复bug和完善功能
- 支持多端发布（如支付宝小程序、H5等）

通过以上计划，我们可以将现有Vue项目平滑迁移到uni-app框架，开发出功能完整、性能良好的微信小程序，同时保持代码的可维护性和扩展性。