<script setup>
// âœ… å¼•å…¥ç»„ä»¶
import TabBar from '@/components/TabBar.vue'
import { ref, onMounted } from 'vue'
import { onShow } from '@dcloudio/uni-app'

// å¸ˆå‚…åˆ—è¡¨æ•°æ®
const masters = ref([
  {
    id: 1,
    name: 'å¼ å»ºå›½',
    avatar: 'å¼ ',
    jobNumber: 'YX20250001',
    title: 'é‡‘ç‰Œå·¥é•¿',
    rating: 4.9,
    experience: '15å¹´',
    serviceCount: 1280,
    region: 'ä¸Šæµ·å¸‚Â·æµ¦ä¸œæ–°åŒº',
    certifications: ['å®åè®¤è¯', 'é‡‘ç‰Œå·¥é•¿', 'æŒè¯ä¸Šå²—', 'å›½ä¼èƒŒæ™¯', 'æ“…é•¿ç–‘éš¾æ‚ç—‡']
  },
  {
    id: 2,
    name: 'æå¼º',
    avatar: 'æ',
    jobNumber: 'YX20250002',
    title: 'é«˜çº§æŠ€å¸ˆ',
    rating: 4.8,
    experience: '8å¹´',
    serviceCount: 860,
    region: 'ä¸Šæµ·å¸‚Â·æµ¦ä¸œæ–°åŒº',
    certifications: ['å®åè®¤è¯', 'é«˜çº§æŠ€å¸ˆ', 'æŒè¯ä¸Šå²—', 'å›½ä¼èƒŒæ™¯']
  },
  {
    id: 3,
    name: 'ç‹ç£Š',
    avatar: 'ç‹',
    jobNumber: 'YX20250003',
    title: 'èµ„æ·±å¸ˆå‚…',
    rating: 4.7,
    experience: '10å¹´',
    serviceCount: 980,
    region: 'ä¸Šæµ·å¸‚Â·æµ¦ä¸œæ–°åŒº',
    certifications: ['å®åè®¤è¯', 'èµ„æ·±å¸ˆå‚…', 'æŒè¯ä¸Šå²—', 'å›½ä¼èƒŒæ™¯']
  }
])

// æœç´¢å…³é”®è¯
const searchKeyword = ref('')

// è¿”å›ä¸Šä¸€é¡µ
const goBack = () => {
  uni.navigateBack()
}

// è·³è½¬åˆ°å¸ˆå‚…è¯¦æƒ…
const goToMasterDetail = (masterId) => {
  console.log('è·³è½¬åˆ°å¸ˆå‚…è¯¦æƒ…ï¼ŒID:', masterId)
  uni.navigateTo({ url: `/pages/master/detail?id=${masterId}` })
}

// æœç´¢å¸ˆå‚…
const searchMasters = () => {
  console.log('æœç´¢å¸ˆå‚…:', searchKeyword.value)
  // è¿™é‡Œå¯ä»¥æ·»åŠ æœç´¢é€»è¾‘
}

onMounted(() => {
  console.log('å¸ˆå‚…åˆ—è¡¨é¡µé¢åŠ è½½')
})

// âœ… éšè—åŸç”ŸTabBar
onShow(() => {
  
})
</script>

<template>
  <view class="master-list-page" style="min-height: 100vh; background-color: #f5f7fa; padding-bottom: 200rpx;">
    <!-- é¡µé¢æ ‡é¢˜æ  -->
    <view style="background-color: #CC0010; border-bottom-left-radius: 48rpx; border-bottom-right-radius: 48rpx; padding: 32rpx 40rpx 48rpx; text-align: center; position: relative;">
      <view class="back-button" style="position: absolute; left: 20rpx; top: 20rpx; width: 80rpx; height: 80rpx; display: flex; align-items: center; justify-content: center; color: white; font-size: 40rpx; cursor: pointer; z-index: 99999; background: rgba(255,255,255,0.1); border-radius: 50%;" @click="goBack">
        â†
      </view>
      <view style="color: white; font-size: 36rpx; font-weight: 700; margin: 0;">æ‰¾å¸ˆå‚…</view>
    </view>

    <!-- æœç´¢æ  -->
    <view style="padding: 32rpx;">
      <view style="background: white; border: 2rpx solid #E5E7EB; border-radius: 40rpx; padding: 16rpx 32rpx; display: flex; align-items: center; gap: 16rpx; box-shadow: 0 8rpx 24rpx rgba(0,0,0,0.1);">
        <view style="color: #6b7280; font-size: 32rpx;">ğŸ”</view>
        <input 
          v-model="searchKeyword" 
          type="text" 
          placeholder="è¯·è¾“å…¥å§“åæˆ–å·¥å·æŸ¥è¯¢" 
          style="flex: 1; border: none; outline: none; font-size: 28rpx; color: #111827;"
          @keyup.enter="searchMasters"
        >
        <button 
          @click="searchMasters" 
          style="background: #CC0010; color: white; border: none; padding: 12rpx 32rpx; border-radius: 24rpx; font-size: 28rpx; font-weight: 500; cursor: pointer;"
        >
          æœç´¢
        </button>
      </view>
    </view>

    <!-- å¸ˆå‚…åˆ—è¡¨ -->
    <view style="padding: 0 32rpx;">
      <view style="font-size: 28rpx; color: #6b7280; margin-bottom: 24rpx;">æŸ¥è¯¢ç»“æœï¼š({{ masters.length }}æ¡ä¿¡æ¯)</view>
      
      <!-- å¸ˆå‚…åˆ—è¡¨é¡¹ -->
      <view v-for="master in masters" :key="master.id" 
           style="background: white; border: 2rpx solid #E5E7EB; border-radius: 32rpx; padding: 32rpx; margin-bottom: 32rpx; box-shadow: 0 8rpx 24rpx rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease;" 
           @click="goToMasterDetail(master.id)"
           @touchstart="$event.currentTarget.style.boxShadow = '0 12rpx 40rpx rgba(0,0,0,0.15)'"
           @touchend="$event.currentTarget.style.boxShadow = '0 8rpx 24rpx rgba(0,0,0,0.1)'">
        <!-- å¸ˆå‚…åŸºæœ¬ä¿¡æ¯ -->
        <view style="display: flex; gap: 32rpx; margin-bottom: 24rpx;">
          <view style="width: 120rpx; height: 120rpx; border-radius: 50%; background: #CC0010; border: 4rpx solid #CC0010; display: flex; align-items: center; justify-content: center; color: white; font-size: 48rpx; font-weight: bold;">{{ master.avatar }}</view>
          <view style="flex: 1;">
            <view style="display: flex; align-items: center; gap: 16rpx; margin-bottom: 8rpx;">
              <view style="font-weight: 500; font-size: 32rpx; color: #111827;">{{ master.name }}</view>
              <view style="background: #CC0010; color: white; font-size: 24rpx; padding: 4rpx 16rpx; border-radius: 20rpx;">{{ master.title }}</view>
            </view>
            <view style="font-size: 28rpx; color: #6b7280; margin-bottom: 16rpx;">å·¥å·ï¼š{{ master.jobNumber }}</view>
            <view style="display: flex; gap: 32rpx;">
              <view style="font-size: 24rpx; color: #9ca3af;">æ‰€åœ¨åŒºåŸŸï¼š{{ master.region }}</view>
              <view style="font-size: 24rpx; color: #9ca3af;">ä»ä¸šå¹´é™ï¼š{{ master.experience }}</view>
            </view>
          </view>
          <view style="display: flex; align-items: center; gap: 16rpx;">
            <view style="display: flex; align-items: center; gap: 8rpx;">
              <span style="font-size: 28rpx; color: #CC0010; font-weight: 500;">{{ master.rating }}</span>
              <span style="font-size: 24rpx; color: #6b7280;">è¯„åˆ†</span>
            </view>
          </view>
        </view>
        
        <!-- è®¤è¯æ ‡ç­¾ -->
        <view style="display: flex; flex-wrap: wrap; gap: 16rpx;">
          <view v-for="(cert, index) in master.certifications" :key="index" 
               :style="{
                 background: cert === 'é‡‘ç‰Œå·¥é•¿' ? '#FEE2E2' : '#DBEAFE',
                 color: cert === 'é‡‘ç‰Œå·¥é•¿' ? '#CC0010' : '#3B82F6',
                 fontSize: '24rpx',
                 padding: '4rpx 16rpx',
                 borderRadius: '24rpx',
                 border: '2rpx solid ' + (cert === 'é‡‘ç‰Œå·¥é•¿' ? '#FECACA' : '#BFDBFE')
               }">
            {{ cert }}
          </view>
          <view style="background: #D1FAE5; color: #059669; font-size: 24rpx; padding: 4rpx 16rpx; border-radius: 24rpx; border: 2rpx solid #A7F3D0;">
            æœˆæ˜Ÿé˜²æ°´å®˜æ–¹è®¤è¯
          </view>
        </view>
      </view>
      
      <!-- ç©ºçŠ¶æ€ -->
      <view v-if="masters.length === 0" style="background: white; border-radius: 32rpx; padding: 80rpx 40rpx; text-align: center; box-shadow: 0 8rpx 24rpx rgba(0,0,0,0.1);">
        <view style="font-size: 96rpx; margin-bottom: 32rpx;">ğŸ‘·</view>
        <view style="font-size: 32rpx; color: #6b7280; margin-bottom: 16rpx;">æš‚æ— å¸ˆå‚…ä¿¡æ¯</view>
        <view style="font-size: 28rpx; color: #9ca3af;">è¯·å°è¯•å…¶ä»–æœç´¢æ¡ä»¶</view>
      </view>
    </view>
    
    <TabBar />
  </view>
</template>

<style scoped>
.master-list-page {
  padding-bottom: 200rpx;
}
</style>
